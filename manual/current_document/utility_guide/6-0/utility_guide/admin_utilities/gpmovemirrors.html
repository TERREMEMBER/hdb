<!doctype html>
<html>
<head>
  <meta charset=UTF-8"utf-8">
  <!-- Always force latest IE rendering engine or request Chrome Frame -->
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

  
  <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,300italic,400italic,400,600' rel='stylesheet' type='text/css'>
  <!-- Use title if it's in the page YAML frontmatter -->
  <title>hdbmovemirrors</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="../../../stylesheets/all.css" rel="stylesheet" media="screen, print" />
  <link href="../../../stylesheets/print.css" rel="stylesheet" media="print" />
  <link href='../../../images/favicon.ico' rel='shortcut icon'>

  <script src="../../../javascripts/all.js"></script>
  
</head>

<body class="x6-0 x6-0_utility_guide x6-0_utility_guide_admin_utilities x6-0_utility_guide_admin_utilities_hdbmovemirrors has-subnav">

<div class="viewport">
  <div class="wrap">
    <script type="text/javascript">
    </script>

     
  <HEADER class="header header-layout">
    <h1 class="logo">
      <a href="http://47.92.231.67:8080/">inHybrid Database Documentation</a>
    </h1>
    
    <div class="header-links js-bar-links">
      <div class="btn-menu" data-behavior="MenuMobile"></div>
      <div class="header-item"><A href="https://greenplum.org">Back to inHybrid Database</a></div>
      <div class="header-item">
        <A href="https://github.com/greenplum-db/hdb/wiki">Wiki</a>
      </div>
      
    </div></HEADER>


    <div class="container"><!--googleoff: index-->
      <div id="sub-nav" role="navigation" class ="nav-container js-sidenav">
  <a class="sidenav-title" data-behavior="SubMenuMobile">
    Doc Index
  </a>
  <div class="nav-content">
    
  <ul>
    
      <li >
        <A href="../../homenav.html">inHybrid数据库 6.0文档</a>
        

      </li>
    
      <li class="has_submenu">
        <A href="../utility_guide.html">工具指南</a>
        
  <ul>
    
      <li class="has_submenu">
        <A href="util_ref.html">管理工具参考</a>
        
  <ul>
    
      <li >
        <A href="analyzedb.html">analyzedb</a>
        

      </li>
    
      <li >
        <A href="hdbactivatestandby.html">hdbactivatestandby</a>
        

      </li>
    
      <li >
        <A href="hdbaddmirrors.html">hdbaddmirrors</a>
        

      </li>
    
      <li >
        <A href="hdbbackup.html">hdbbackup</a>
        

      </li>
    
      <li >
        <A href="gpcheck.html">gpcheck</a>
        

      </li>
    
      <li >
        <A href="hdbcheckcat.html">hdbcheckcat</a>
        

      </li>
    
      <li >
        <A href="hdbcheckperf.html">hdbcheckperf</a>
        

      </li>
    
      <li >
        <A href="hdbconfig.html">hdbconfig</a>
        

      </li>
    
      <li >
        <A href="hdbdeletesystem.html">hdbdeletesystem</a>
        

      </li>
    
      <li >
        <A href="hdbexpand.html">hdbexpand</a>
        

      </li>
    
      <li >
        <A href="hdbfdist.html">hdbfdist</a>
        

      </li>
    
      <li >
        <A href="hdbinitstandby.html">hdbinitstandby</a>
        

      </li>
    
      <li >
        <A href="hdbinitsystem.html">hdbinitsystem</a>
        

      </li>
    
      <li >
        <A href="hdbload.html">hdbload</a>
        

      </li>
    
      <li >
        <A href="hdblogfilter.html">hdblogfilter</a>
        

      </li>
    
      <li >
        <A href="hdbmapreduce.html">hdbmapreduce</a>
        

      </li>
    
      <li >
        <A href="hdbmovemirrors.html">hdbmovemirrors</a>
        

      </li>
    
      <li >
        <A href="hdbperfmon_install.html">hdbperfmon_install</a>
        

      </li>
    
      <li >
        <A href="hdbpkg.html">hdbpkg</a>
        

      </li>
    
      <li >
        <A href="hdbrecoverseg.html">hdbrecoverseg</a>
        

      </li>
    
      <li >
        <A href="hdbreload.html">hdbreload</a>
        

      </li>
    
      <li >
        <A href="hdbrestore.html">hdbrestore</a>
        

      </li>
    
      <li >
        <A href="hdbscp.html">hdbscp</a>
        

      </li>
    
      <li >
        <A href="gpseginstall.html">gpseginstall</a>
        

      </li>
    
      <li >
        <A href="hdbssh.html">hdbssh</a>
        

      </li>
    
      <li >
        <A href="hdbssh-exkeys.html">hdbssh-exkeys</a>
        

      </li>
    
      <li >
        <A href="hdbstart.html">hdbstart</a>
        

      </li>
    
      <li >
        <A href="hdbstate.html">hdbstate</a>
        

      </li>
    
      <li >
        <A href="hdbstop.html">hdbstop</a>
        

      </li>
    
      <li >
        <A href="gpsys.html">hdbsys1</a>
        

      </li>
    
      <li >
        <A href="pgbouncer.html">pgbouncer</a>
        

      </li>
    
      <li >
        <A href="pgbouncer-ini.html">pgbouncer.ini</a>
        

      </li>
    
      <li >
        <A href="pgbouncer-admin.html">pgbouncer-admin</a>
        

      </li>
    
      <li >
        <A href="../../pxf/ref/pxf.html">pxf</a>
        

      </li>
    
      <li >
        <A href="../../pxf/ref/pxf-cluster.html">pxf cluster</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <A href="../cli_ref.html">客户端工具参考</a>
        
  <ul>
    
      <li class="has_submenu">
        <A href="../client_utilities/ClientUtilitySummary.html">客户端工具摘要</a>
        
  <ul>
    
      <li >
        <A href="../client_utilities/clusterdb.html">clusterdb</a>
        

      </li>
    
      <li >
        <A href="../client_utilities/createdb.html">createdb</a>
        

      </li>
    
      <li >
        <A href="../client_utilities/createlang.html">createlang</a>
        

      </li>
    
      <li >
        <A href="../client_utilities/createuser.html">createuser</a>
        

      </li>
    
      <li >
        <A href="../client_utilities/dropdb.html">dropdb</a>
        

      </li>
    
      <li >
        <A href="../client_utilities/droplang.html">droplang</a>
        

      </li>
    
      <li >
        <A href="../client_utilities/dropuser.html">dropuser</a>
        

      </li>
    
      <li >
        <A href="../client_utilities/pg_config.html">pg_config</a>
        

      </li>
    
      <li >
        <A href="../client_utilities/pg_dump.html">pg_dump</a>
        

      </li>
    
      <li >
        <A href="../client_utilities/pg_dumpall.html">pg_dumpall</a>
        

      </li>
    
      <li >
        <A href="../client_utilities/pg_restore.html">pg_restore</a>
        

      </li>
    
      <li >
        <A href="../client_utilities/psql.html">psql</a>
        

      </li>
    
      <li >
        <A href="../client_utilities/reindexdb.html">reindexdb</a>
        

      </li>
    
      <li >
        <A href="../client_utilities/vacuumdb.html">vacuumdb</a>
        

      </li>
    
  </ul>


      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <A href="../contrib-programs.html">附加程序</a>
        
  <ul>
    
      <li >
        <A href="https://www.postgresql.org/docs/9.4/pgupgrade.html">pg_upgrade</a>
        

      </li>
    
      <li >
        <A href="https://www.postgresql.org/docs/9.4/pgxlogdump.html">pg_xlogdump</a>
        

      </li>
    
  </ul>


      </li>
    
  </ul>


      </li>
    
  </ul>


  </div>
</div><!--googleon: index-->

      <main class="content content-layout" id="js-content" role="main">
        <a id="top"></a>
        
          <h1 class="title-container" style="display: none;">
    hdbmovemirrors
  </h1>

          <div id="js-quick-links" >
            
          </div>
        <div class="to-top" id="js-to-top">
          <A title="back to top" href="hdbmovemirrors.html#top" ></a>
        </div>
        

  <h1 class="title topictitle1">hdbmovemirrors</h1>

  <div class="body">
    <p class="p">移动镜像实例到新位置</p>

    <div class="section" id="topic1__section2">
<h2 class="title sectiontitle">概要</h2>
      
      <pre class="pre codeblock"><strong class="ph b">hdbmovemirrors</strong> <strong class="ph b">-i</strong> <var class="keyword varname">move_config_file</var> [<strong class="ph b">-d</strong> <var class="keyword varname">master_data_directory</var>]   
          [<strong class="ph b">-l</strong> <var class="keyword varname">logfile_directory</var>]   
          [<strong class="ph b">-B</strong> <var class="keyword varname">parallel_processes</var>] [<strong class="ph b">-v</strong>
]


<strong class="ph b">hdbmovemirrors</strong> <strong class="ph b">-?</strong> 
 


<strong class="ph b">hdbmovemirrors</strong> <strong class="ph b">--version</strong></pre>

    </div>

    <div class="section" id="topic1__section3">
<h2 class="title sectiontitle">描述</h2>
      
      <p class="p"><samp class="ph codeph">hdbmovemirrors</samp>工具将镜像实例移动到新位置。客户可能会想移动镜像到新位置以优化分布
        和数据存储</p>

      <p class="p">在移动Segment之前，该工具会验证Mirror是否存在，他们对应的主节点是否在线和目前同步状态在同步还是
        异步模式。</p>

      <p class="p">默认情况下，工具会提示您输入所有镜像要移动到的文件系统路径。</p>

      <p class="p">客户必须保证运行<samp class="ph codeph">hdbmovemirrors</samp>的用户（<samp class="ph codeph">hdbadmin</samp>用户）
        拥有该位置的访问权限。所以最好在运行<samp class="ph codeph">hdbmovemirrors</samp>工具之前在各个Segment主机
        上创建好对应的路径，并使用<samp class="ph codeph">chown</samp>命令付给指定用户相应的权限。
        </p>

    </div>

    <div class="section" id="topic1__section4">
<h2 class="title sectiontitle">选项</h2>
      
      <dl class="dl parml">
        
          <dt class="dt pt dlterm">-B <var class="keyword varname">parallel_processes</var>
</dt>

          <dd class="dd pd">要并行移动的镜像Segment数量。如果不指定，工具默认启动4个并行进程，具体数量与
            要移动多少镜像实例数量有关。</dd>

        
        
          <dt class="dt pt dlterm">-d <var class="keyword varname">master_data_directory</var>
</dt>

          <dd class="dd pd">主机数据目录。如果不指定，默认使用<samp class="ph codeph">$MASTER_DATA_DIRECTORY</samp>
            的值。</dd>

        
        
          <dt class="dt pt dlterm">-i <var class="keyword varname">move_config_file</var>
</dt>

          <dd class="dd pd">包含哪些镜像要被移动，被移动到哪里等信息的配置文件。
            </dd>

          <dd class="dd pd">每一个主Segment必须有一个对应的镜像Segment列出。配置文件中的每行都用以下格式
            （就像<samp class="ph codeph">gp_segment_configuration</samp>元数据表中的信息一样）：</dd>

          <dd class="dd pd">
            <pre class="pre codeblock"><var class="keyword varname">contentID</var>:<var class="keyword varname">address</var>:<var class="keyword varname">port</var>:<var class="keyword varname">data_dir</var> <var class="keyword varname">new_address</var>:<var class="keyword varname">port</var>:<var class="keyword varname">data_dir</var></pre>

          </dd>

          <dd class="dd pd">
<var class="keyword varname">contentID</var>是Segment实例的content ID，
            <var class="keyword varname">address</var>是Segment主机的主机名或IP地址，
            <var class="keyword varname">port</var>是沟通端口，<samp class="ph codeph">data_dir</samp>是Segment
            实例的数据目录。</dd>

        
        
          <dt class="dt pt dlterm">-l <var class="keyword varname">logfile_directory</var>
</dt>

          <dd class="dd pd">日志写入路径。默认为<samp class="ph codeph">~/hdbAdminLogs</samp>。</dd>

        
        
          <dt class="dt pt dlterm">-v（详细日志）</dt>

          <dd class="dd pd">设置日志输出为详细级别。</dd>

        
        
          <dt class="dt pt dlterm">--version（显示工具版本）</dt>

          <dd class="dd pd">显示工具的版本信息。</dd>

        
        
          <dt class="dt pt dlterm">-?（帮助）</dt>

          <dd class="dd pd">显示在线帮助信息。</dd>

        
      </dl>

    </div>

    <div class="section" id="topic1__section5">
<h2 class="title sectiontitle">示例</h2>
      
      <p class="p">将inHybrid数据库系统移动到一个不同的主机集合：</p>

      <pre class="pre codeblock">$ hdbmovemirrors -i move_config_file</pre>

      <p class="p">此处<samp class="ph codeph">move_config_file</samp>的配置信息如下：</p>

      <pre class="pre codeblock">1:sdw2:50001:/data2/mirror/hdbseg1 sdw3:50001:/data/mirror/hdbseg1
2:sdw2:50001:/data2/mirror/hdbseg2 sdw4:50001:/data/mirror/hdbseg2
3:sdw3:50001:/data2/mirror/hdbseg3 sdw1:50001:/data/mirror/hdbseg3
</pre>

    </div>

  </div>
    </main>
    </div>
  </div>
</div>

<div id="scrim"></div>

<div class="container">
  <FOOTER class="site-footer-links">
</FOOTER>
</div><!--end of container-->

</body>
</html>
