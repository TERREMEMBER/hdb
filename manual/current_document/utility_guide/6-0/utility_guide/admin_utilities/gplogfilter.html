<!doctype html>
<html>
<head>
  <meta charset=UTF-8"utf-8">
  <!-- Always force latest IE rendering engine or request Chrome Frame -->
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

  
  <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,300italic,400italic,400,600' rel='stylesheet' type='text/css'>
  <!-- Use title if it's in the page YAML frontmatter -->
  <title>hdblogfilter</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="../../../stylesheets/all.css" rel="stylesheet" media="screen, print" />
  <link href="../../../stylesheets/print.css" rel="stylesheet" media="print" />
  <link href='../../../images/favicon.ico' rel='shortcut icon'>

  <script src="../../../javascripts/all.js"></script>
  
</head>

<body class="x6-0 x6-0_utility_guide x6-0_utility_guide_admin_utilities x6-0_utility_guide_admin_utilities_hdblogfilter has-subnav">

<div class="viewport">
  <div class="wrap">
    <script type="text/javascript">
    </script>

     
  <HEADER class="header header-layout">
    <h1 class="logo">
      <a href="http://47.92.231.67:8080/">inHybrid Database Documentation</a>
    </h1>
    
    <div class="header-links js-bar-links">
      <div class="btn-menu" data-behavior="MenuMobile"></div>
      <div class="header-item"><A href="https://greenplum.org">Back to inHybrid Database</a></div>
      <div class="header-item">
        <A href="https://github.com/greenplum-db/hdb/wiki">Wiki</a>
      </div>
      
    </div></HEADER>


    <div class="container"><!--googleoff: index-->
      <div id="sub-nav" role="navigation" class ="nav-container js-sidenav">
  <a class="sidenav-title" data-behavior="SubMenuMobile">
    Doc Index
  </a>
  <div class="nav-content">
    
  <ul>
    
      <li >
        <A href="../../homenav.html">inHybrid数据库 6.0文档</a>
        

      </li>
    
      <li class="has_submenu">
        <A href="../utility_guide.html">工具指南</a>
        
  <ul>
    
      <li class="has_submenu">
        <A href="util_ref.html">管理工具参考</a>
        
  <ul>
    
      <li >
        <A href="analyzedb.html">analyzedb</a>
        

      </li>
    
      <li >
        <A href="hdbactivatestandby.html">hdbactivatestandby</a>
        

      </li>
    
      <li >
        <A href="hdbaddmirrors.html">hdbaddmirrors</a>
        

      </li>
    
      <li >
        <A href="hdbbackup.html">hdbbackup</a>
        

      </li>
    
      <li >
        <A href="gpcheck.html">gpcheck</a>
        

      </li>
    
      <li >
        <A href="hdbcheckcat.html">hdbcheckcat</a>
        

      </li>
    
      <li >
        <A href="hdbcheckperf.html">hdbcheckperf</a>
        

      </li>
    
      <li >
        <A href="hdbconfig.html">hdbconfig</a>
        

      </li>
    
      <li >
        <A href="hdbdeletesystem.html">hdbdeletesystem</a>
        

      </li>
    
      <li >
        <A href="hdbexpand.html">hdbexpand</a>
        

      </li>
    
      <li >
        <A href="hdbfdist.html">hdbfdist</a>
        

      </li>
    
      <li >
        <A href="hdbinitstandby.html">hdbinitstandby</a>
        

      </li>
    
      <li >
        <A href="hdbinitsystem.html">hdbinitsystem</a>
        

      </li>
    
      <li >
        <A href="hdbload.html">hdbload</a>
        

      </li>
    
      <li >
        <A href="hdblogfilter.html">hdblogfilter</a>
        

      </li>
    
      <li >
        <A href="hdbmapreduce.html">hdbmapreduce</a>
        

      </li>
    
      <li >
        <A href="hdbmovemirrors.html">hdbmovemirrors</a>
        

      </li>
    
      <li >
        <A href="hdbperfmon_install.html">hdbperfmon_install</a>
        

      </li>
    
      <li >
        <A href="hdbpkg.html">hdbpkg</a>
        

      </li>
    
      <li >
        <A href="hdbrecoverseg.html">hdbrecoverseg</a>
        

      </li>
    
      <li >
        <A href="hdbreload.html">hdbreload</a>
        

      </li>
    
      <li >
        <A href="hdbrestore.html">hdbrestore</a>
        

      </li>
    
      <li >
        <A href="hdbscp.html">hdbscp</a>
        

      </li>
    
      <li >
        <A href="gpseginstall.html">gpseginstall</a>
        

      </li>
    
      <li >
        <A href="hdbssh.html">hdbssh</a>
        

      </li>
    
      <li >
        <A href="hdbssh-exkeys.html">hdbssh-exkeys</a>
        

      </li>
    
      <li >
        <A href="hdbstart.html">hdbstart</a>
        

      </li>
    
      <li >
        <A href="hdbstate.html">hdbstate</a>
        

      </li>
    
      <li >
        <A href="hdbstop.html">hdbstop</a>
        

      </li>
    
      <li >
        <A href="gpsys.html">hdbsys1</a>
        

      </li>
    
      <li >
        <A href="pgbouncer.html">pgbouncer</a>
        

      </li>
    
      <li >
        <A href="pgbouncer-ini.html">pgbouncer.ini</a>
        

      </li>
    
      <li >
        <A href="pgbouncer-admin.html">pgbouncer-admin</a>
        

      </li>
    
      <li >
        <A href="../../pxf/ref/pxf.html">pxf</a>
        

      </li>
    
      <li >
        <A href="../../pxf/ref/pxf-cluster.html">pxf cluster</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <A href="../cli_ref.html">客户端工具参考</a>
        
  <ul>
    
      <li class="has_submenu">
        <A href="../client_utilities/ClientUtilitySummary.html">客户端工具摘要</a>
        
  <ul>
    
      <li >
        <A href="../client_utilities/clusterdb.html">clusterdb</a>
        

      </li>
    
      <li >
        <A href="../client_utilities/createdb.html">createdb</a>
        

      </li>
    
      <li >
        <A href="../client_utilities/createlang.html">createlang</a>
        

      </li>
    
      <li >
        <A href="../client_utilities/createuser.html">createuser</a>
        

      </li>
    
      <li >
        <A href="../client_utilities/dropdb.html">dropdb</a>
        

      </li>
    
      <li >
        <A href="../client_utilities/droplang.html">droplang</a>
        

      </li>
    
      <li >
        <A href="../client_utilities/dropuser.html">dropuser</a>
        

      </li>
    
      <li >
        <A href="../client_utilities/pg_config.html">pg_config</a>
        

      </li>
    
      <li >
        <A href="../client_utilities/pg_dump.html">pg_dump</a>
        

      </li>
    
      <li >
        <A href="../client_utilities/pg_dumpall.html">pg_dumpall</a>
        

      </li>
    
      <li >
        <A href="../client_utilities/pg_restore.html">pg_restore</a>
        

      </li>
    
      <li >
        <A href="../client_utilities/psql.html">psql</a>
        

      </li>
    
      <li >
        <A href="../client_utilities/reindexdb.html">reindexdb</a>
        

      </li>
    
      <li >
        <A href="../client_utilities/vacuumdb.html">vacuumdb</a>
        

      </li>
    
  </ul>


      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <A href="../contrib-programs.html">附加程序</a>
        
  <ul>
    
      <li >
        <A href="https://www.postgresql.org/docs/9.4/pgupgrade.html">pg_upgrade</a>
        

      </li>
    
      <li >
        <A href="https://www.postgresql.org/docs/9.4/pgxlogdump.html">pg_xlogdump</a>
        

      </li>
    
  </ul>


      </li>
    
  </ul>


      </li>
    
  </ul>


  </div>
</div><!--googleon: index-->

      <main class="content content-layout" id="js-content" role="main">
        <a id="top"></a>
        
          <h1 class="title-container" style="display: none;">
    hdblogfilter
  </h1>

          <div id="js-quick-links" >
            
          </div>
        <div class="to-top" id="js-to-top">
          <A title="back to top" href="hdblogfilter.html#top" ></a>
        </div>
        
<h1 class="title topictitle1">hdblogfilter</h1>
<div class="body">
  <p class="p">在inHybrid数据库日志文件中搜索指定的项。</p>

  <div class="section" id="topic1__section2">
<h2 class="title sectiontitle">概要</h2>
    
    <pre class="pre codeblock"><strong class="ph b">hdblogfilter</strong> [<var class="keyword varname">timestamp_options</var>] [<var class="keyword varname">pattern_options</var>]   
      [<var class="keyword varname">output_options</var>] [<var class="keyword varname">input_options</var>] [<var class="keyword varname">input_file</var>]   
        
      <strong class="ph b">hdblogfilter</strong> <strong class="ph b">--help</strong>   
        
      <strong class="ph b">hdblogfilter</strong> <strong class="ph b">--version</strong></pre>
</div>
<div class="section" id="topic1__section3">
<h2 class="title sectiontitle">描述</h2>
        
        <p class="p"><samp class="ph codeph">hdblogfilter</samp>工具可以被用来在一个inHybrid数据库日志文件中搜索匹配指定条件的项。
          如果没有提供输入文件，那么<samp class="ph codeph">hdblogfilter</samp>将使用环境变量<samp class="ph codeph">$MASTER_DATA_DIRECTORY</samp>
          在标准日志位置定位inHybrid的Master日志文件。要从标准输入读取，可用一个破折号（<samp class="ph codeph">-</samp>）作为输入文件名。
          输入文件可以被使用<samp class="ph codeph">gzip</samp>压缩。在输入文件中，日志项由其<samp class="ph codeph">YYYY-MM-DD [hh:mm[:ss]]</samp>
          格式的时间戳标识。</p>

        <p class="p">如果通过<samp class="ph codeph"><A class="xref" href="hdbssh.html#topic1">hdbssh</a></samp>工具运行
          <samp class="ph codeph">hdblogfilter</samp>，用户还可以用它来一次搜索所有的Segment日志文件。例如，要显示每个Segment
          日志文件中的最后三行：
        </p>
<pre class="pre codeblock">hdbssh -f seg_host_file
          =&gt; source /usr/local/inhybrid-db/inhybrid_path.sh
          =&gt; hdblogfilter -n 3 /hdbdata/*/pg_log/hdb*.csv</pre>

        <p class="p"><samp class="ph codeph">hdblogfilter</samp>的输出默认被发送到标准输出。可以使用<samp class="ph codeph">-o</samp>选项把输出发送到一个文件或者一个目录。
          如果用户提供了一个以<samp class="ph codeph">.gz</samp>结束的输出文件名，该输出文件默认将被以最大压缩率压缩。如果输出目标是一个目录，
          输出文件将被命名为输入文件的名字。</p>
</div>

  <div class="section" id="topic1__section4">
<h2 class="title sectiontitle">选项</h2>
    <div class="sectiondiv">
      <strong class="ph b">时间戳选项</strong>
      <dl class="dl parml">
        
          <dt class="dt pt dlterm">-b <var class="keyword varname">datetime</var> | --begin=<var class="keyword varname">datetime</var>
</dt>

          <dd class="dd pd">以格式<samp class="ph codeph">YYYY-MM-DD [hh:mm[:ss]]</samp>指定要搜索的日志项的开始日期和时间。
          </dd>

          <dd class="dd pd">如果指定一个时间，日期和时间必须被封闭在单引号或者双引号中。这个例子将日期和时间封闭在单引号中：
          </dd>

          <dd class="dd pd">
<pre class="pre codeblock">hdblogfilter -b '2013-05-23 14:33'</pre>
</dd>
<dt class="dt pt dlterm">-e <var class="keyword varname">datetime</var> | --end=<var class="keyword varname">datetime</var>
</dt>

            <dd class="dd pd">指定一个<samp class="ph codeph">YYYY-MM-DD [hh:mm[:ss]]</samp>格式的结束日期和时间来停止搜索日志信息。
            </dd>

          
        
          <dt class="dt pt dlterm">-d <var class="keyword varname">time</var> | --duration=<var class="keyword varname">time</var>
</dt>

          <dd class="dd pd">以<samp class="ph codeph">[hh][:mm[:ss]]</samp>格式指定要搜索的日志项所在的时间长度。如果指定这个选项
            但没有指定<samp class="ph codeph">-b</samp>或<samp class="ph codeph">-e</samp>选项，将使用当前时间作为基础。
          </dd>

        
      </dl>

    </div>
    <div class="sectiondiv">
      <strong class="ph b">模式匹配选项</strong>
      <dl class="dl parml">
<dt class="dt pt dlterm">-c i [gnore] | r [espect] | --case=i [gnore] | r [espect]</dt>

        <dd class="dd pd">除非前面放上<samp class="ph codeph">--case=ignore</samp>选项，字母表符号的匹配默认是大小写敏感的。
        </dd>

      
        
          <dt class="dt pt dlterm">-C '<var class="keyword varname">string</var>' | --columns='<var class="keyword varname">string</var>'</dt>

          <dd class="dd pd">从日志文件中选择特定的列。将想要的列指定为由逗号定界的列编号串，列编号从1开始，
            从左到右依次是1、2、3等等。<span class="ph">关于日志文件格式的详情以及可用列的列表及其相关编号
              请见<em class="ph i">inHybrid数据库管理员指南</em>中的“查看数据库服务器日志文件”部分。
            </span>
          </dd>

        
        
          <dt class="dt pt dlterm">-f '<var class="keyword varname">string</var>' | --find='<var class="keyword varname">string</var>'</dt>

          <dd class="dd pd">查找包含指定字符串的日志项。</dd>

        
        
          <dt class="dt pt dlterm">-F '<var class="keyword varname">string</var>' | --nofind='<var class="keyword varname">string</var>'</dt>

          <dd class="dd pd">拒绝包含指定字符串的日志项。</dd>

        
        
          <dt class="dt pt dlterm">-m <var class="keyword varname">regex</var> | --match=<var class="keyword varname">regex</var>
</dt>

          <dd class="dd pd">查找匹配指定的Python正则表达式的日志项。Python正则表达式语法请参考
            <A class="xref" href="https://docs.python.org/library/re.html" target="_blank">
              https://docs.python.org/library/re.html</a>
          </dd>

        
        
          <dt class="dt pt dlterm">-M <var class="keyword varname">regex</var> | --nomatch=<var class="keyword varname">regex</var>
</dt>

          <dd class="dd pd">拒绝匹配指定Python正则表达式的日志项。Python正则表达式语法请参考
            <A class="xref" href="https://docs.python.org/library/re.html" target="_blank">
              https://docs.python.org/library/re.html</a>
          </dd>

        
        
          <dt class="dt pt dlterm">-t | --trouble</dt>

          <dd class="dd pd">只查找在第一行有<samp class="ph codeph">ERROR:</samp>、<samp class="ph codeph">FATAL:</samp>或者
            <samp class="ph codeph">PANIC:</samp>的日志项。
          </dd>

        
      </dl>

    </div>
    <div class="sectiondiv">
      <strong class="ph b">输出选项</strong>
      <dl class="dl parml">
        
          <dt class="dt pt dlterm">-n <var class="keyword varname">integer</var> | --tail=<var class="keyword varname">integer</var>
</dt>

          <dd class="dd pd">限制输出为找到的符合条件日志项中的最后<var class="keyword varname">integer</var>项。</dd>

        
        
          <dt class="dt pt dlterm">-s <var class="keyword varname">offset</var> [limit] | --slice=<var class="keyword varname">offset</var> [limit]</dt>

          <dd class="dd pd">从符合条件的日志项列表中，从<var class="keyword varname">offset</var>项处开始返回<var class="keyword varname">limit</var>个项，
            其中为零（<samp class="ph codeph">0</samp>）的<var class="keyword varname">offset</var>指示结果集中的第一项并且任何不超过零的
            <var class="keyword varname">offset</var>表示从结果集的末尾开始数。
          </dd>

        
        
          <dt class="dt pt dlterm">-o <var class="keyword varname">output_file</var> | --out=<var class="keyword varname">output_file</var>
</dt>

          <dd class="dd pd">将输出写到指定的文件或者目录位置而不是<samp class="ph codeph">STDOUT</samp>。
          </dd>

        
        
          <dt class="dt pt dlterm">-z 0-9 | --zip=0-9</dt>

          <dd class="dd pd">使用<samp class="ph codeph">gzip</samp>把输出文件压缩到指定的压缩级别，其中<samp class="ph codeph">0</samp>
            是不压缩而<samp class="ph codeph">9</samp>是最大压缩。如果用户提供一个以<samp class="ph codeph">.gz</samp>
            结束的输出文件名，该输出文件默认将被使用最大压缩级别压缩。
          </dd>

        
        
          <dt class="dt pt dlterm">-a | --append</dt>

          <dd class="dd pd">如果输出文件已经存在，会追加到该文件而不是覆盖它。</dd>

        
      </dl>

    </div>
    <div class="sectiondiv">
      <strong class="ph b">输入选项</strong>
      <dl class="dl parml">
        
          <dt class="dt pt dlterm">input_file</dt>

          <dd class="dd pd">要在其中搜索的输入日志文件的名称。如果没有提供输入文件，<samp class="ph codeph">hdblogfilter</samp>
            将使用环境变量<samp class="ph codeph">$MASTER_DATA_DIRECTORY</samp>来定位inHybrid数据库的Master
            日志文件。要从标准输入读取，可使用一个破折号（<samp class="ph codeph">-</samp>）作为输入文件名。
          </dd>

        
        
          <dt class="dt pt dlterm">-u | --unzip</dt>

          <dd class="dd pd">使用<samp class="ph codeph">gunzip</samp>解压输入文件。如果输入文件名以<samp class="ph codeph">.gz</samp>结束，
            它默认将被解压。
          </dd>

        
        
          <dt class="dt pt dlterm">--help</dt>

          <dd class="dd pd">显示在线帮助。</dd>

        
          <dt class="dt pt dlterm">--version</dt>

          <dd class="dd pd">显示这个工具的版本。</dd>

        
      </dl>

    </div>
  </div>

  <div class="section" id="topic1__section9">
<h2 class="title sectiontitle">示例</h2>
    
    <p class="p">显示Master日志文件中的最后三个错误消息：</p>

    <pre class="pre codeblock">hdblogfilter -t -n 3</pre>

    <p class="p">显示Master日志文件中时间戳位于最后10分钟内的所有日志消息：</p>

    <pre class="pre codeblock">hdblogfilter -d :10</pre>

    <p class="p">显示Master日志文件中包含字符串<samp class="ph codeph">|con6
      cmd11|</samp>的日志消息：</p>

    <pre class="pre codeblock">hdblogfilter -f '|con6 cmd11|'</pre>

    <p class="p">使用<samp class="ph codeph"><A class="xref" href="hdbssh.html#topic1">hdbssh</a></samp>
      在Segment主机上运行<samp class="ph codeph">hdblogfilter</samp>并且在Segment日志文件中搜索含有字符串
      <samp class="ph codeph">con6</samp>的日志消息，把输出保存到一个文件。</p>

    <pre class="pre codeblock">hdbssh -f seg_hosts_file -e 'source   
      /usr/local/inhybrid-db/inhybrid_path.sh ; hdblogfilter -f   
      con6 /hdbdata/*/pg_log/hdb*.csv' &gt; seglog.out</pre>
</div>

  <div class="section" id="topic1__section10">
<h2 class="title sectiontitle">另见</h2>
    
    <p class="p">
      <samp class="ph codeph">
        <A class="xref" href="hdbssh.html#topic1">hdbssh</a></samp>、<samp class="ph codeph"><A class="xref" href="hdbscp.html#topic1">hdbscp</a></samp></p>
</div>
</div>
    </main>
    </div>
  </div>
</div>

<div id="scrim"></div>

<div class="container">
  <FOOTER class="site-footer-links">
</FOOTER>
</div><!--end of container-->

</body>
</html>
