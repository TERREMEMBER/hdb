<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Always force latest IE rendering engine or request Chrome Frame -->
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

  
  <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,300italic,400italic,400,600' rel='stylesheet' type='text/css'>
  <!-- Use title if it's in the page YAML frontmatter -->
  <title>
      Estimating Storage Capacity |
    inHybrid Database Docs
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="../../stylesheets/all.css" rel="stylesheet" media="screen, print" />
  <link href="../../stylesheets/print.css" rel="stylesheet" media="print" />
  <link href='../../images/favicon.ico' rel='shortcut icon'>

  <script src="../../javascripts/all.js"></script>
  
</head>

<body class="x6-4 x6-4_install_guide x6-4_install_guide_capacity_planning has-subnav">

<div class="viewport">
  <div class='wrap'>
    <script type="text/javascript">

    </script>

     
  <header class="header header-layout">
    <h1 class="logo">
      <a href="../../index.html">inHybrid Database Documentation</a>
    </h1>
    
    <div class="header-links js-bar-links">
      <div class="btn-menu" data-behavior="MenuMobile"></div>
      <div class="header-item"><a href="https://greenplum.org">Back to inHybrid Database</a></div>
      <div class="header-item">
        <a href="https://github.com/greenplum-db/hdb/wiki">Wiki</a>
      </div>
      
    </div>
  </header>


    <div class="container">

      <!--googleoff: index-->
      <div id="sub-nav" class="nav-container js-sidenav" role="navigation" >
  <a class="sidenav-title" data-behavior="SubMenuMobile">
    Doc Index
  </a>
  <div class="nav-content">
    
  <ul>
    
      <li class="">
        <a href="../homenav.html">inspur inHybrid 6.4 Documentation</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="install_guide.html">Installation Guide</a>
        
  <ul>
    
      <li class="">
        <a href="platform-requirements.html">Platform Requirements</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="preinstall_concepts.html">Introduction to inHybrid</a>
        
  <ul>
    
      <li class="">
        <a href="preinstall_concepts.html#topic2">The inHybrid Master</a>
        

      </li>
    
      <li class="">
        <a href="preinstall_concepts.html#topic4">The Segments</a>
        

      </li>
    
      <li class="">
        <a href="preinstall_concepts.html#topic9">The Interconnect</a>
        

      </li>
    
      <li class="">
        <a href="preinstall_concepts.html#topic13">ETL Hosts for Data Loading</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="has_submenu">
        <a href="capacity_planning.html">Estimating Storage Capacity</a>
        
  <ul>
    
      <li class="">
        <a href="capacity_planning.html#topic2">Calculating Usable Disk Capacity</a>
        

      </li>
    
      <li class="">
        <a href="capacity_planning.html#topic3">Calculating User Data Size</a>
        

      </li>
    
      <li class="">
        <a href="capacity_planning.html#topic4">Calculating Space Requirements for Metadata and Logs</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="prep_os.html">Configuring Your Systems</a>
        

      </li>
    
      <li class="">
        <a href="install_hdb.html">Installing the inHybrid Database Software</a>
        

      </li>
    
      <li class="">
        <a href="create_data_dirs.html">Creating the Data Storage Areas</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="validate.html">Validating Your Systems</a>
        
  <ul>
    
      <li class="">
        <a href="validate.html#topic4">Validating Network Performance</a>
        

      </li>
    
      <li class="">
        <a href="validate.html#topic5">Validating Disk I&#x2F;O and Memory Bandwidth</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="init_hdb.html">Initializing a inHybrid Database System</a>
        

      </li>
    
      <li class="">
        <a href="install_modules.html">Installing Additional Supplied Modules</a>
        

      </li>
    
      <li class="">
        <a href="localization.html">Configuring Timezone and Localization Settings</a>
        

      </li>
    
      <li class="">
        <a href="upgrading.html">Upgrading from an Earlier inHybrid 6 Release</a>
        

      </li>
    
      <li class="">
        <a href="migrate.html">Migrating Data from inHybrid 4.3 or 5</a>
        

      </li>
    
      <li class="">
        <a href="enable_iptables.html">Enabling iptables (Optional)</a>
        

      </li>
    
      <li class="">
        <a href="apx_mgmt_utils.html">Installation Management Utilities</a>
        

      </li>
    
      <li class="has_submenu">
        <a href="env_var_ref.html">inHybrid Environment Variables</a>
        
  <ul>
    
      <li class="">
        <a href="env_var_ref.html#topic2">Required Environment Variables</a>
        

      </li>
    
      <li class="">
        <a href="env_var_ref.html#topic7">Optional Environment Variables</a>
        

      </li>
    
  </ul>


      </li>
    
      <li class="">
        <a href="ansible-example.html">Example Ansible Playbook</a>
        

      </li>
    
  </ul>


      </li>
    
  </ul>


  </div>
</div>

      <!--googleon: index-->

      <main class="content content-layout" id="js-content" role="main">
        <a id="top"></a>
        
          <h1 class="title-container" style="display: none;">
    估计存储容量
  </h1>

          <div id="js-quick-links" >
            
          </div>
        <div class="to-top" id="js-to-top">
          <a href="capacity_planning.html#top" title="back to top"></a>
        </div>
        

  <h1 class="title topictitle1">估计存储容量</h1>

  <p class="shortdesc">要估计inHybrid数据库系统可以容纳多少数据，请使用这些测量作为指导。还要记住，您可能需要有额外的空间用于在每个segment主机上登录备份文件和数据加载文件。 </p>

  <div class="related-links">
<ul class="ullinks">
<li class="link ulchildlink">
<strong><a href="capacity_planning.html#topic2">计算可用磁盘容量</a></strong><br>
</li>
<li class="link ulchildlink">
<strong><a href="capacity_planning.html#topic3">计算用户数据大小</a></strong><br>
</li>
<li class="link ulchildlink">
<strong><a href="capacity_planning.html#topic4">计算元数据和日志的空间需求</a></strong><br>
</li>
</ul>

<div class="familylinks">
<div class="parentlink">
<strong>Parent topic:</strong> <a class="link" href="install_guide.html" title="Information about installing, configuring, and upgrading inHybrid Database software and configuring inHybrid Database host machines.">安装和升级inHybrid</a>
</div>
</div>
</div>
<div class="topic nested1" xml:lang="en" lang="en" id="topic2">
    <h2 class="title topictitle2">计算可用磁盘容量</h2>

    <div class="body">
      <p class="p">要计算inHybrid数据库系统可以容纳多少数据，必须计算每个segment主机的可用磁盘容量，然后将其乘以inHybrid数据库数组中的segment主机数。从可用于数据存储的segment主机上物理磁盘的原始容量(<var class="keyword varname">raw_capacity</var>), 要计算inHybrid数据库系统可以容纳多少数据，必须计算每个segment主机的可用磁盘容量，然后将其乘以inHybrid数据库数组中的segment主机数。从可用于数据存储的segment主机上物理磁盘的原始容量（原始容量）开始，即：</p>

      <pre class="pre codeblock"><var class="keyword varname">disk_size</var> * <var class="keyword varname">number_of_disks</var></pre>

      <p class="p">占文件系统格式化开销（大约10%）和您使用的RAID级别。例如，如果使用RAID-10，计算结果将是：</p>

      <pre class="pre codeblock">(<var class="keyword varname">raw_capacity</var> * 0.9) / 2 = <var class="keyword varname">formatted_disk_space</var></pre>

      <p class="p">为了获得最佳性能，不要将磁盘完全填满到容量，而是以70%或更低的速度运行。考虑到这一点，计算可用磁盘空间如下：</p>

      <pre class="pre codeblock"><var class="keyword varname">formatted_disk_space</var> * 0.7 = <var class="keyword varname">usable_disk_space</var></pre>

      <p class="p">仅使用70%的磁盘空间，inHybrid数据库就可以将另外30%的空间用于同一磁盘上的临时文件和事务文件。如果主机系统有一个单独的磁盘系统，可用于临时文件和事务文件，则可以指定inHybrid数据库用于文件的表空间。根据磁盘系统的性能，移动文件的位置可能会提高性能。</p>

      <div class="p">格式化RAID磁盘阵列并计算出最大建议容量（可用磁盘空间）后，需要计算用户数据（U）实际可用的存储空间。如果使用inHybrid数据库镜像进行数据冗余，那么这将使用户数据的大小（2*U）增加一倍。inHybrid数据库还需要保留一些空间作为活动查询的工作区。工作空间应大约为用户数据大小的三分之一（工作空间=U/3）：<pre class="pre codeblock"><strong class="ph b">With mirrors:</strong> (2 * U) + U/3 = <var class="keyword varname">usable_disk_space</var>

<strong class="ph b">Without mirrors:</strong> U + U/3 = <var class="keyword varname">usable_disk_space</var></pre>
</div>

      <p class="p">临时文件空间和用户数据空间的指南假定一个典型的分析工作负载。高度并发的工作负载或带有查询的工作负载需要非常大的临时空间，可以从保留更大的工作区域中获益。通常，通过适当的工作负载管理，可以在降低工作区使用率的同时提高总体系统吞吐量。此外，通过指定临时空间和用户空间位于不同的表空间，可以将它们彼此隔离。</p>

      <p class="p">在inHybrid数据库管理员指南中，请参阅以下主题：</p>

      <ul class="ul">
        <li class="li" id="topic2__jh161458">
<a class="xref" href="../admin_guide/partV.html" title="The topics in this section cover inHybrid Database performance management, including how to monitor performance and how to configure workloads to prioritize resource utilization.">管理工作负载管理信息的性能 </li>

        <li class="li" id="topic2__jh161469">
<a class="xref" href="../admin_guide/ddl/ddl-tablespace.html">创建和管理表空间，以获取有关移动临时文件和事务文件位置的信息 </li>

        <li class="li" id="topic2__jh161162">
<a class="xref" href="../admin_guide/managing/monitor.html#topic3">监控系统状态，获取有关监控inHybrid数据库磁盘空间使用情况的信息</li>

      </ul>

    </div>

  <div class="related-links">
<div class="familylinks">
<div class="parentlink">
<strong>Parent topic:</strong> <a class="link" href="capacity_planning.html" title="To estimate how much data your inHybrid Database system can accommodate, use these measurements as guidelines. Also keep in mind that you may want to have extra space for landing backup files and data load files on each segment host.">估计存储容量</a>
</div>
</div>
</div>
</div>

  <div class="topic nested1" xml:lang="en" lang="en" id="topic3">
    <h2 class="title topictitle2">计算用户数据大小</h2>

    <div class="body">
      <p class="p">与所有数据库一样，一旦原始数据加载到数据库中，其大小将稍微大一些。平均而言，原始数据在加载到数据库后在磁盘上的大小约为1.4倍，但根据所使用的数据类型、表存储类型、数据库压缩等，原始数据可能会更小或更大。</p>

      <ul class="ul">
        <li class="li" id="topic3__jh157686">页面开销-当您的数据加载到inHybrid数据库中时，它被分为每个32KB的页面。每个页面都有20字节的页面开销。</li>

        <li class="li" id="topic3__jh157687">行开销-在常规的“堆”存储表中，每行数据都有24字节的行开销。“append optimized”存储表只有4字节的行开销。</li>

        <li class="li" id="topic3__jh157688">属性开销-对于数据值本身，与每个属性值关联的大小取决于所选的数据类型。一般来说，您希望使用尽可能小的数据类型来存储数据（假设您知道列可能具有的值）</li>

        <li class="li" id="topic3__jh157689">索引-在inHybrid数据库中，索引按表数据分布在segment主机上。inHybrid数据库中的默认索引类型是B-tree。由于索引大小取决于索引中唯一值的数目和要插入的数据，因此不可能预先计算索引的确切大小。但是，可以使用这些公式粗略估计索引的大小。<pre class="pre codeblock"><strong class="ph b">B-tree:</strong> <var class="keyword varname">unique_values</var> * (<var class="keyword varname">data_type_size</var> + 24 bytes)

<strong class="ph b">Bitmap:</strong> (<var class="keyword varname">unique_values</var> * <var class="keyword varname">number_of_rows</var> * 1 bit * <var class="keyword varname">compression_ratio</var> / 8) + (<var class="keyword varname">unique_values</var> * 32)</pre>
</li>

      </ul>

    </div>

  <div class="related-links">
<div class="familylinks">
<div class="parentlink">
<strong>Parent topic:</strong> <a class="link" href="capacity_planning.html" title="To estimate how much data your inHybrid Database system can accommodate, use these measurements as guidelines. Also keep in mind that you may want to have extra space for landing backup files and data load files on each segment host.">估计存储容量</a>
</div>
</div>
</div>
</div>

  <div class="topic nested1" xml:lang="en" lang="en" id="topic4">
    <h2 class="title topictitle2">计算元数据和日志的空间需求</h2>

    <div class="body">
      <p class="p">在每个段主机上，您还需要为inHybrid数据库日志文件和元数据占用空间：</p>

      <ul class="ul">
        <li class="li" id="topic4__jh159754">
<strong class="ph b">系统元数据</strong> ― 对于在主机上运行的每个inHybrid数据库segment实例（主实例或镜像实例）或主实例，估计系统目录和元数据约为20 MB。</li>

        <li class="li" id="topic4__jh159758">
<strong class="ph b">预写日志</strong> ― 对于主机上运行的每个inHybrid数据库segment（primary或mirror）或master实例，为预写日志（WAL）分配空间。WAL被分成每个64MB的segment文件。最多，WAL文件的数量将是：<pre class="pre codeblock">2 * <var class="keyword varname">checkpoint_segments</var> + 1</pre>
<p class="p">你可以用这个来估计WAL的空间需求。inHybrid数据库实例的默认 checkpoint_segment设置为8，这意味着为主机上的每个segment或master实例分配1088MB的WAL空间。</p>
</li>

        <li class="li" id="topic4__jh159765">
<strong class="ph b">inHybrid数据库日志文件</strong> ― 每个segment实例和master实例生成数据库日志文件，这些文件将随着时间的推移而增长。应该为这些日志文件分配足够的空间，并且应该使用某种类型的日志轮换工具来确保to日志文件不会变得太大</li>

        <li class="li" id="topic4__jh160818">
<strong class="ph b">指挥中心数据</strong> ― 指挥中心使用的数据收集代理与inHybrid数据库实例在同一组主机上运行，并利用这些主机的系统资源。这些主机上的数据收集代理进程的资源消耗是最小的，不应显著影响数据库性能。收集代理收集的历史数据存储在inHybrid数据库系统中自己的命令中心数据库（名为gpperfmon）中。收集的数据就像普通数据库数据一样分布，因此您需要在inHybrid segment实例的数据目录位置中考虑磁盘空间。所需的空间量取决于要保留的历史数据量。历史数据不会自动截断。数据库管理员必须设置截断策略以保持命令中心数据库的大小。</li>

      </ul>

    </div>

  <div class="related-links">
<div class="familylinks">
<div class="parentlink">
<strong>Parent topic:</strong> <a class="link" href="capacity_planning.html" title="To estimate how much data your inHybrid Database system can accommodate, use these measurements as guidelines. Also keep in mind that you may want to have extra space for landing backup files and data load files on each segment host.">估计存储容量</a>
</div>
</div>
</div>
</div>



        

      </main>
    </div>
  </div>
</div>

<div id="scrim"></div>

<div class="container">
  <footer class="site-footer-links">
    
  </footer>
</div><!--end of container-->

</body>
</html>
